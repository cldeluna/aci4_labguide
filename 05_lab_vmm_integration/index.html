


<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="ACI Version 4 Lab Guide">
      
      
        <link rel="canonical" href="https://github.com/cldeluna/aci4_labguide.git/05_lab_vmm_integration/">
      
      
        <meta name="author" content="Claudia de Luna">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-5.1.6">
    
    
      
        <title>Lab 05 - Integration with VMware ESXi - ACI 4 Lab Guide</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.4b9ffd7b.min.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/palette.b79bcd20.min.css">
      
      
        
        
        <meta name="theme-color" content="#3f51b5">
      
    
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
      
    
    
    
    
      
        
<link rel="preconnect dns-prefetch" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-XXXXXXXX-X","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}),document.addEventListener("DOMContentSwitch",function(){ga("send","pageview")})</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
      
    
    
  </head>
  
  
    
    
    <body dir="ltr" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#05-lab-integrate-aci-with-vmware-using-native-distributed-virtual-switch-dvs" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid" aria-label="Header">
    <a href="https://github.com/cldeluna/aci4_labguide.git" title="ACI 4 Lab Guide" class="md-header-nav__button md-logo" aria-label="ACI 4 Lab Guide">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header-nav__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header-nav__title" data-md-component="header-title">
      
        <div class="md-header-nav__ellipsis">
          <span class="md-header-nav__topic md-ellipsis">
            ACI 4 Lab Guide
          </span>
          <span class="md-header-nav__topic md-ellipsis">
            
              Lab 05 - Integration with VMware ESXi
            
          </span>
        </div>
      
    </div>
    
      <label class="md-header-nav__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active">
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0116 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 019.5 16 6.5 6.5 0 013 9.5 6.5 6.5 0 019.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" data-md-component="search-reset" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header-nav__source">
        
<a href="https://github.com/cldeluna/aci4_labguide.git/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    cldeluna/aci4_labguide
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
        
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="https://github.com/cldeluna/aci4_labguide.git" title="ACI 4 Lab Guide" class="md-nav__button md-logo" aria-label="ACI 4 Lab Guide">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 003-3 3 3 0 00-3-3 3 3 0 00-3 3 3 3 0 003 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    ACI 4 Lab Guide
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/cldeluna/aci4_labguide.git/" title="Go to repository" class="md-source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 00-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 01-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 000 40.81l195.61 195.6a28.86 28.86 0 0040.8 0l194.69-194.69a28.86 28.86 0 000-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    cldeluna/aci4_labguide
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../topology/" title="Topology & Design" class="md-nav__link">
      Topology & Design
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../lab_access/" title="Getting Around the Lab" class="md-nav__link">
      Getting Around the Lab
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../01_lab_fabric_discovery/" title="Lab 01 - Fabric Discovery" class="md-nav__link">
      Lab 01 - Fabric Discovery
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../02_lab_fabric_access_policies/" title="Lab 02 - Fabric & Access Policies" class="md-nav__link">
      Lab 02 - Fabric & Access Policies
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../03_lab_tenant_constructs/" title="Lab 03 - Tenants" class="md-nav__link">
      Lab 03 - Tenants
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../04_lab_layer2_connectivity/" title="Lab 04 - Host & Layer 2 Connectivity" class="md-nav__link">
      Lab 04 - Host & Layer 2 Connectivity
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Lab 05 - Integration with VMware ESXi
        <span class="md-nav__icon md-icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 9h14V7H3v2m0 4h14v-2H3v2m0 4h14v-2H3v2m16 0h2v-2h-2v2m0-10v2h2V7h-2m0 6h2v-2h-2v2z"/></svg>
        </span>
      </label>
    
    <a href="./" title="Lab 05 - Integration with VMware ESXi" class="md-nav__link md-nav__link--active">
      Lab 05 - Integration with VMware ESXi
    </a>
    
      
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-goals" class="md-nav__link">
    Lab Goals
  </a>
  
    <nav class="md-nav" aria-label="Lab Goals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-configure-access-policies-for-vmm-domain-dynamic-vlan-pool-and-new-aaep" class="md-nav__link">
    Step 1 - Configure Access Policies for VMM Domain  (Dynamic Vlan Pool and new AAEP)
  </a>
  
    <nav class="md-nav" aria-label="Step 1 - Configure Access Policies for VMM Domain  (Dynamic Vlan Pool and new AAEP)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-11-configure-a-dynamic-vlan-pool" class="md-nav__link">
    Step 1.1 - Configure a Dynamic Vlan Pool
  </a>
  
    <nav class="md-nav" aria-label="Step 1.1 - Configure a Dynamic Vlan Pool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vlan-pool-vlan-allocations-table" class="md-nav__link">
    Vlan Pool Vlan Allocations Table
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-12-configure-a-new-aaep" class="md-nav__link">
    Step 1.2 - Configure a new AAEP
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-configure-a-vcenter-vmm-domain" class="md-nav__link">
    Step 2 - Configure a vCenter VMM Domain
  </a>
  
    <nav class="md-nav" aria-label="Step 2 - Configure a vCenter VMM Domain">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-21-vcenter-domain" class="md-nav__link">
    Step 2.1 - vCenter Domain
  </a>
  
    <nav class="md-nav" aria-label="Step 2.1 - vCenter Domain">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vcenter-settings-table" class="md-nav__link">
    vCenter Settings Table
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-22-vcenter-credentials" class="md-nav__link">
    Step 2.2 - vCenter Credentials
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-23-vcenter-server" class="md-nav__link">
    Step 2.3 - vCenter Server
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-verify-cisco-apic-connection-to-vmware-vcenter-server" class="md-nav__link">
    Step 3 - Verify Cisco APIC Connection to VMware vCenter Server
  </a>
  
    <nav class="md-nav" aria-label="Step 3 - Verify Cisco APIC Connection to VMware vCenter Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-31-verify-that-the-apic-has-discovered-vcenter" class="md-nav__link">
    Step 3.1 Verify that the APIC has discovered vCenter
  </a>
  
    <nav class="md-nav" aria-label="Step 3.1 Verify that the APIC has discovered vCenter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vmnic-map-for-pod" class="md-nav__link">
    VMNIC Map for POD
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-verify-that-the-apic-has-provisioned-a-dvs-in-vcenter" class="md-nav__link">
    Step 4 - Verify that the APIC has Provisioned a DVS in vCenter
  </a>
  
    <nav class="md-nav" aria-label="Step 4 - Verify that the APIC has Provisioned a DVS in vCenter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-41-accessing-vcenter" class="md-nav__link">
    Step 4.1 Accessing vCenter
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../06_lab_layer3_connectivity/" title="Lab 06 - External Layer 3 Connectivity" class="md-nav__link">
      Lab 06 - External Layer 3 Connectivity
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../07_lab_operations/" title="Lab 07 - Management & Operations" class="md-nav__link">
      Lab 07 - Management & Operations
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../08_lab_fwl_integration/" title="Lab 08 - Firewall Integration" class="md-nav__link">
      Lab 08 - Firewall Integration
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../09_lab_troubeleshooting/" title="Lab 09 - Troubleshooting" class="md-nav__link">
      Lab 09 - Troubleshooting
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../10_lab_programmability/" title="Lab 10 - Programmability" class="md-nav__link">
      Lab 10 - Programmability
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../11_lab_appcenter/" title="Lab 11 - App Center and ACI Optimize Feature" class="md-nav__link">
      Lab 11 - App Center and ACI Optimize Feature
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../12_lab_techsupport/" title="Lab 12 - Export Tech Support" class="md-nav__link">
      Lab 12 - Export Tech Support
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    Overview
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#lab-goals" class="md-nav__link">
    Lab Goals
  </a>
  
    <nav class="md-nav" aria-label="Lab Goals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-1-configure-access-policies-for-vmm-domain-dynamic-vlan-pool-and-new-aaep" class="md-nav__link">
    Step 1 - Configure Access Policies for VMM Domain  (Dynamic Vlan Pool and new AAEP)
  </a>
  
    <nav class="md-nav" aria-label="Step 1 - Configure Access Policies for VMM Domain  (Dynamic Vlan Pool and new AAEP)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-11-configure-a-dynamic-vlan-pool" class="md-nav__link">
    Step 1.1 - Configure a Dynamic Vlan Pool
  </a>
  
    <nav class="md-nav" aria-label="Step 1.1 - Configure a Dynamic Vlan Pool">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vlan-pool-vlan-allocations-table" class="md-nav__link">
    Vlan Pool Vlan Allocations Table
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-12-configure-a-new-aaep" class="md-nav__link">
    Step 1.2 - Configure a new AAEP
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-configure-a-vcenter-vmm-domain" class="md-nav__link">
    Step 2 - Configure a vCenter VMM Domain
  </a>
  
    <nav class="md-nav" aria-label="Step 2 - Configure a vCenter VMM Domain">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-21-vcenter-domain" class="md-nav__link">
    Step 2.1 - vCenter Domain
  </a>
  
    <nav class="md-nav" aria-label="Step 2.1 - vCenter Domain">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vcenter-settings-table" class="md-nav__link">
    vCenter Settings Table
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-22-vcenter-credentials" class="md-nav__link">
    Step 2.2 - vCenter Credentials
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-23-vcenter-server" class="md-nav__link">
    Step 2.3 - vCenter Server
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-verify-cisco-apic-connection-to-vmware-vcenter-server" class="md-nav__link">
    Step 3 - Verify Cisco APIC Connection to VMware vCenter Server
  </a>
  
    <nav class="md-nav" aria-label="Step 3 - Verify Cisco APIC Connection to VMware vCenter Server">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-31-verify-that-the-apic-has-discovered-vcenter" class="md-nav__link">
    Step 3.1 Verify that the APIC has discovered vCenter
  </a>
  
    <nav class="md-nav" aria-label="Step 3.1 Verify that the APIC has discovered vCenter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vmnic-map-for-pod" class="md-nav__link">
    VMNIC Map for POD
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-verify-that-the-apic-has-provisioned-a-dvs-in-vcenter" class="md-nav__link">
    Step 4 - Verify that the APIC has Provisioned a DVS in vCenter
  </a>
  
    <nav class="md-nav" aria-label="Step 4 - Verify that the APIC has Provisioned a DVS in vCenter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-41-accessing-vcenter" class="md-nav__link">
    Step 4.1 Accessing vCenter
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/cldeluna/aci4_labguide.git/edit/master/docs/05_lab_vmm_integration.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                  
                
                
                <h1 id="05-lab-integrate-aci-with-vmware-using-native-distributed-virtual-switch-dvs">05 Lab Integrate ACI with VMware Using Native Distributed Virtual Switch (DVS)<a class="headerlink" href="#05-lab-integrate-aci-with-vmware-using-native-distributed-virtual-switch-dvs" title="Permanent link">&para;</a></h1>
<h2 id="overview">Overview<a class="headerlink" href="#overview" title="Permanent link">&para;</a></h2>
<p>One of the most powerful features of ACI is its native integration with the Virtualization Environment.</p>
<p>The steps in this lab will integrate ACI APICs with the VMware environment (already configured) via vCenter so that VMs on ESXi hosts will be able to connect to the Logical ACI environment and take advantage of the security we built in Lab 3.  In ACI this configuration construct is called a Virtual Machine Manager (VMM) Domain.</p>
<p>This integration allows the ACI APIC to communicate with vCenter as though it were an Administrator and automatically set up the required networking the Virtual Machines will need to communicate securely on the ACI fabric.</p>
<p>Required Services and Information </p>
<ul>
<li>Administrator level account on vCenter</li>
<li>Admin Username</li>
<li>Admin Password</li>
<li>The exact name of an existing Data Center configured in vCenter to which we want to integreate</li>
</ul>
<p>In a production environment it is best practice to create a dedicated account for this integration, but in the lab we use the already existing admin account and credentials.</p>
<p>This lab specifically calls out the default VMware DVS which is part of ESXi.   That is because ACI supports integration with VMware vCenter using:</p>
<ul>
<li>Distributed Virtual Switch (DVS)  </li>
<li>Native to VMware</li>
<li>Cisco Application Virtual Switch AVS</li>
<li>Cisco ACI Virtual Edge (AVE) (From ACI 3.1(1) and VMware vCenter 6.0 and later)</li>
<li>Next generation virtual switch from Cisco</li>
</ul>
<p>In this lab we will focus on native VDS integration as it is part of VMware.</p>
<h2 id="lab-goals">Lab Goals<a class="headerlink" href="#lab-goals" title="Permanent link">&para;</a></h2>
<p>At the completion of this lab, you will have enabled the ACI APIC to communicate to the vCenter managing the ESXi Host in your Lab, configured the apporpriate Fabric Access Objects to allow the correct vlans to present to the ACI managed VMware VDS within vCenter and connect VMs to the correct EPGs via the corresponding Port Groups created by the ACI  integration. </p>
<p>Step 1 - Configure Access Policies for VMM Domain  (Dynamic Vlan Pool and new AAEP)</p>
<p>Step 2 - Configure a vCenter VMM Domain</p>
<p>Step 3 - Verify Cisco APIC Connection to VMware vCenter Server</p>
<p>Step 4 - Verify that the APIC has Provisioned a DVS in vCenter</p>
<p>Step 5 - Add ESXi Host to ACI APIC Provisioned DVS</p>
<p>Step 6 - Associate VMM Domain to EPGs</p>
<p>Step 7 - Test EPG Connectivity</p>
<h4 id="step-1-configure-access-policies-for-vmm-domain-dynamic-vlan-pool-and-new-aaep">Step 1 - Configure Access Policies for VMM Domain  (Dynamic Vlan Pool and new AAEP)<a class="headerlink" href="#step-1-configure-access-policies-for-vmm-domain-dynamic-vlan-pool-and-new-aaep" title="Permanent link">&para;</a></h4>
<h5 id="step-11-configure-a-dynamic-vlan-pool">Step 1.1 - Configure a Dynamic Vlan Pool<a class="headerlink" href="#step-11-configure-a-dynamic-vlan-pool" title="Permanent link">&para;</a></h5>
<p>Navigate to Fabric &gt;  Access Policies &gt; VLAN and right-click on the VLAN folder icon and select <strong>Create VLAN Pool</strong></p>
<p>Allocation Mode: Dynamic Allocation</p>
<h6 id="vlan-pool-vlan-allocations-table">Vlan Pool Vlan Allocations Table<a class="headerlink" href="#vlan-pool-vlan-allocations-table" title="Permanent link">&para;</a></h6>
<table>
<thead>
<tr>
<th>VLAN Range:</th>
<th>Value</th>
<th>Allocation Mode</th>
</tr>
</thead>
<tbody>
<tr>
<td>Range (From)</td>
<td>3##1</td>
<td>Dynamic</td>
</tr>
<tr>
<td>Range (To)</td>
<td>3##9</td>
<td>Dynamic</td>
</tr>
</tbody>
</table>
<p>* Replace ## with your assigned 2-digit Pod number</p>
<p>Note: Vlan 3##0 is part of the Static Pool</p>
<p>Click the plus sign (+) in the Encap Blocks table to configure the range.</p>
<p>Allocation Mode: Inherit allocMode from parent</p>
<p>Role: External or On the wire encapsulations</p>
<p>You will recall creating a static Vlan Pool in Lab 2.  With dynamic allocation, the APIC will automatically assign VLANS as needed within the range you define.  This facilitates automation as well as eases the burden of configuration.  </p>
<p>The role defines the use of the VLAN range.  External or On the wire encapsulation is used for allocating VLANS for each EPG associated to the VMM domain.  The VLANs are used when packets are sent to or from Leaf switches.  The internal role is used for private VLAN allocations in the internal vSwitch by the Cisco ACI Virtual Edge (AVE).  With the Intenral role, the VLANS are not seen outside of the ESXi host or on the wire.</p>
<p>Click OK to return to the pool configuration dialog and click Submit.</p>
<h5 id="step-12-configure-a-new-aaep">Step 1.2 - Configure a new AAEP<a class="headerlink" href="#step-12-configure-a-new-aaep" title="Permanent link">&para;</a></h5>
<p>In Lab 2 we configured </p>
<p>Configure AAEP to Selectively Allow Vlan Traffic.</p>
<p>Attachable Access Entity Profiles (AAEPs) can be considered the "where" of the fabric configuration and are used to group domains with similar requirements.  They allow a one to many relationship between the policy groups and domains.</p>
<p>AEPs are tied to interface policy groups. One ore more domains are added to an AAEP. By grouping domains into AAEPs and associating them, the fabric knows where the various devices in the domain reside.  Cisco APIC can push the Vlans and policy to the required interfaces.</p>
<p>Step 1.3 - Host Connectivity to VDS </p>
<h4 id="step-2-configure-a-vcenter-vmm-domain">Step 2 - Configure a vCenter VMM Domain<a class="headerlink" href="#step-2-configure-a-vcenter-vmm-domain" title="Permanent link">&para;</a></h4>
<p>Its important to remember that what you are actually configuring with a VMM Domain is a virtual switch on the Hypervisor(s) (ESXi) via the hypervisor manager (vCenter in our case).</p>
<h5 id="step-21-vcenter-domain">Step 2.1 - vCenter Domain<a class="headerlink" href="#step-21-vcenter-domain" title="Permanent link">&para;</a></h5>
<p>Navigate to Virtual <strong>Networking &gt; VMM Domains &gt; VMware</strong> and right-click on the VMware folder and select <strong>Create vCenter Domain</strong>.  A Create vCenter Domain dialog will pop up.</p>
<p>Notice the various Hypervisors which can be integrated into ACI. </p>
<h6 id="vcenter-settings-table">vCenter Settings Table<a class="headerlink" href="#vcenter-settings-table" title="Permanent link">&para;</a></h6>
<table>
<thead>
<tr>
<th>Setting:</th>
<th>Value</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td>Virtual Switch Name:</td>
<td>POD11-vCenter-VDS</td>
<td></td>
</tr>
<tr>
<td>Virtual Switch:</td>
<td>VMware vSphere Distributed Switch</td>
<td>Unchanged<br />This is the default value</td>
</tr>
<tr>
<td>Associated Attachable Entity Profile:</td>
<td>Leave Blank</td>
<td></td>
</tr>
<tr>
<td>Access Mode:</td>
<td>Read Write Mode</td>
<td>Unchanged<br />Read Write Mode is the default</td>
</tr>
<tr>
<td>Endpoint Retention Time (seconds)</td>
<td>0</td>
<td>Unchanged<br />This is the default</td>
</tr>
<tr>
<td>VLAN Pool:</td>
<td>POD##-Dynamic-VLAN-Pool</td>
<td>Configured in Lab 2</td>
</tr>
</tbody>
</table>
<p>Enter the name: POD##-vCenter-VDS</p>
<p>Make sure that <strong>VMware vSphere Distributed Switch</strong> is selected </p>
<p>Leave the Associated Attachable Entity Profile (AAEP) empty. You will define it in a later procedure.  Choose your dynamic VLAN pool (POD##-VLANs).</p>
<h5 id="step-22-vcenter-credentials">Step 2.2 - vCenter Credentials<a class="headerlink" href="#step-22-vcenter-credentials" title="Permanent link">&para;</a></h5>
<p>Click the plus sign (+) in the  <strong>vCenter Credentials:</strong> table to define credentials with these settings.</p>
<table>
<thead>
<tr>
<th>Name:</th>
<th>vCenter Username</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>POD##-vCenter-Credentials</td>
<td>administrator@vsphere.local</td>
<td>1234QWer!</td>
</tr>
</tbody>
</table>
<p>Click <strong>OK</strong></p>
<h5 id="step-23-vcenter-server">Step 2.3 - vCenter Server<a class="headerlink" href="#step-23-vcenter-server" title="Permanent link">&para;</a></h5>
<p>Click the plus sign (+) in the <strong>vCenter:</strong> table to define the controller settings (IP, etc.).</p>
<p>Name: POD##-vCenter-Server</p>
<p>The vCenter controller name does not have to match the name of the vCenter domain.    Either the IP or the hostname can be entered.</p>
<table>
<thead>
<tr>
<th>Device</th>
<th>Management IP Address</th>
<th>Username</th>
<th>Password</th>
</tr>
</thead>
<tbody>
<tr>
<td>vCenter-P1</td>
<td>192.168.10.202</td>
<td>administrator@vsphere.local</td>
<td>1234QWer!</td>
</tr>
<tr>
<td>vCenter-P2</td>
<td>192.168.10.204</td>
<td>administrator@vsphere.local</td>
<td>1234QWer!</td>
</tr>
<tr>
<td>vCenter-P3</td>
<td>192.168.10.206</td>
<td>administrator@vsphere.local</td>
<td>1234QWer!</td>
</tr>
<tr>
<td>vCenter-P4</td>
<td>192.168.10.208</td>
<td>administrator@vsphere.local</td>
<td>1234QWer!</td>
</tr>
<tr>
<td>vCenter-P5</td>
<td>192.168.10.210</td>
<td>administrator@vsphere.local</td>
<td>1234QWer!</td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>Setting:</th>
<th>Value</th>
<th>Comments</th>
</tr>
</thead>
<tbody>
<tr>
<td>DVS Version:</td>
<td>DVS Version 6</td>
<td>If you choose the default DVS version (6.5) you would not be able to add the hypervisor with version DVS 6.5 due to a VMware bug</td>
</tr>
<tr>
<td>Stats Collection:</td>
<td>Disabled</td>
<td>This is the default value</td>
</tr>
<tr>
<td>Data center:</td>
<td>DC</td>
<td>The data center name must exactly match the data center name as it is defined in vCenter</td>
</tr>
<tr>
<td>Management  EPG:</td>
<td><Empty></td>
<td>You do not configure any EPG for managing the VMware vCenter because the connection from the Cisco APIC to the vCenter is out-of-band (OOB)</td>
</tr>
<tr>
<td>Associated Credentials:</td>
<td>POD##-vCenter-Credentials</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>Set vSwitch Policy to CDP, leave all other settings at their default values </p>
<p>Click <strong>Submit</strong></p>
<h4 id="step-3-verify-cisco-apic-connection-to-vmware-vcenter-server">Step 3 - Verify Cisco APIC Connection to VMware vCenter Server<a class="headerlink" href="#step-3-verify-cisco-apic-connection-to-vmware-vcenter-server" title="Permanent link">&para;</a></h4>
<h5 id="step-31-verify-that-the-apic-has-discovered-vcenter">Step 3.1 Verify that the APIC has discovered vCenter<a class="headerlink" href="#step-31-verify-that-the-apic-has-discovered-vcenter" title="Permanent link">&para;</a></h5>
<p>Navigate to Virtual Networking &gt; VMM Domains &gt; VMware and expand your vCenter domain and all of its subelements.</p>
<p>Note: The APIC connects to the vCenter and obtains its inventory, including hypervisors, VMs, and uplinks.  You will see all the VMs that have been installed on your host.</p>
<p>Examine the status of the vmnic interfaces.  You can over over them in the Topology page, click them in the naviation pane, or go to the General tab.</p>
<p>vmnic 0,2, and 3 should be up.</p>
<h6 id="vmnic-map-for-pod">VMNIC Map for POD<a class="headerlink" href="#vmnic-map-for-pod" title="Permanent link">&para;</a></h6>
<table>
<thead>
<tr>
<th>VMNIC #</th>
<th>Connected To</th>
<th>Function</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>Management Switch</td>
<td>Management</td>
</tr>
<tr>
<td>2</td>
<td>LEAF-1</td>
<td>Data Path</td>
</tr>
<tr>
<td>3</td>
<td>Leaf-2</td>
<td>Data Path</td>
</tr>
</tbody>
</table>
<h4 id="step-4-verify-that-the-apic-has-provisioned-a-dvs-in-vcenter">Step 4 - Verify that the APIC has Provisioned a DVS in vCenter<a class="headerlink" href="#step-4-verify-that-the-apic-has-provisioned-a-dvs-in-vcenter" title="Permanent link">&para;</a></h4>
<h5 id="step-41-accessing-vcenter">Step 4.1 Accessing vCenter<a class="headerlink" href="#step-41-accessing-vcenter" title="Permanent link">&para;</a></h5>
<p>In Google Chrome open another tab and connect to vCenter via https://vcenter.  The hostname will resolve to 192.168.10.50</p>
<p>Accept the untrusted certificate security warnings and clikc vSphere Web Client (Flash)</p>
<p>If prompted, enable Adobe Flash Playre by clicking its button and choosing Allow</p>
<p>Accept any security warnings and log in as <strong>administrator@vsphere.local</strong> with password <strong>1234QWer!</strong></p>
<p>Go to Networking .  Expand the folder that has been created under your data center (DC).  You should see a DVS wit the name of the configured vCenter domain (POD##-vCenter-vDS), within a folder of the same name.  Expand the DVS to see two networks have been automatically created.  Click the Summary tab to see details about the DVS.</p>
<p>vCenter can take up to 15 minutes upon bootup to be ready.  When vCenter vecomes active and reachable you will be able to see the elements.</p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid" aria-label="Footer">
        
          <a href="../04_lab_layer2_connectivity/" title="Lab 04 - Host & Layer 2 Connectivity" class="md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
            </div>
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Lab 04 - Host & Layer 2 Connectivity
              </div>
            </div>
          </a>
        
        
          <a href="../06_lab_layer3_connectivity/" title="Lab 06 - External Layer 3 Connectivity" class="md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-footer-nav__title">
              <div class="md-ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Lab 06 - External Layer 3 Connectivity
              </div>
            </div>
            <div class="md-footer-nav__button md-icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2020
          </div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
      </div>
      
  <div class="md-footer-social">
    
      
      
        
        
      
      <a href="https://github.com/squidfunk" target="_blank" rel="noopener" title="github.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 480 512"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://twitter.com/squidfunk" target="_blank" rel="noopener" title="twitter.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
      </a>
    
      
      
        
        
      
      <a href="https://linkedin.com/in/squidfunk" target="_blank" rel="noopener" title="linkedin.com" class="md-footer-social__link">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
      </a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/vendor.a0c4167b.min.js"></script>
      <script src="../assets/javascripts/bundle.fb26dd1d.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
      
      <script>
        app = initialize({
          base: "..",
          features: [],
          search: Object.assign({
            worker: "../assets/javascripts/worker/search.37585f48.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
      
    
  </body>
</html>